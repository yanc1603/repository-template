<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Modular Dashboard & UI Kit</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container-fluid">
        <h1 class="title">Modular Template</h1>
        <p class="subtitle">A resilient full-stack template with dynamic module loading and a UI Kit.</p>

        <!-- AUTH MODULE (Login/Register) -->
        <div class="module" id="login-module">
            <div class="card-header">
                <h2>Authentication</h2>
            </div>
            <!-- User Dashboard (Hidden by default) -->
            <div id="user-dashboard" class="hidden" style="padding: 20px; text-align: center;">
                <h3>Welcome, <span id="user-display-name">User</span>!</h3>
                <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
                    <button id="btn-identify-me" class="btn btn-secondary">Identify Me</button>
                    <button id="btn-logout-main" class="btn btn-danger">Logout</button>
                </div>
            </div>

            <div id="auth-forms-container" class="forms-container">
                <!-- Login -->
                <div class="form-box">
                    <h3>Login</h3>
                    <div id="login-message" class="message"></div>
                    <form id="loginForm">
                        <input type="text" name="username" placeholder="Username" required>
                        <input type="password" name="password" placeholder="Password" required>
                        <button type="submit" class="btn btn-primary">Log In</button>
                    </form>
                </div>
                <!-- Register -->
                <div class="form-box">
                    <h3>Register</h3>
                    <div id="register-message" class="message"></div>
                    <form id="registerForm">
                        <input type="text" name="username" placeholder="New Username" required>
                        <input type="password" name="password" placeholder="New Password" required>
                        <button type="submit" class="btn btn-secondary">Register</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- PLAYGROUND MODULE -->
        <div class="module hidden" id="playground-module">
            <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                <h2>Playground Module</h2>
                <button id="btn-logout" class="btn btn-danger">Logout</button>
            </div>

            <div style="margin-bottom: 20px;">
                <input type="text" id="input-title" placeholder="Enter Task Name..."
                    style="width: 70%; display: inline-block;">
                <button id="btn-add" class="btn btn-primary">Add Task</button>
            </div>

            <h3>Database State:</h3>
            <ul id="task-list" style="list-style: none; padding: 0;"></ul>
        </div>

        <!-- API TESTER MODULE -->
        <div class="module" id="api-tester-module">
            <div class="card-header">
                <h2>API Tester</h2>
            </div>
            <div style="padding: 20px;">
                <p>Test API connectivity and endpoints.</p>
                <button id="btn-test-api" class="btn btn-outline">Test '/me' Endpoint</button>
                <pre id="api-output"
                    style="background: #f4f4f4; padding: 10px; margin-top: 10px; border-radius: 5px; min-height: 50px;">Waiting for input...</pre>
                <div style="margin-top: 20px;">
                    <a href="/docs" target="_blank" class="btn btn-primary">Open Swagger UI</a>
                </div>
            </div>
        </div>

        <!-- UI SHOWCASE MODULE (Static) -->
        <div class="module">
            <div class="card-header">
                <h2>UI Kit Showcase</h2>
                <small>Reusable components for your modules</small>
            </div>

            <div class="grid-cols-2">
                <!-- Buttons -->
                <div>
                    <h3>Buttons</h3>
                    <button id="btn-interaction-primary" class="btn btn-primary">Primary</button>
                    <button id="btn-interaction-secondary" class="btn btn-secondary">Secondary</button>
                    <button id="btn-interaction-outline" class="btn btn-outline">Outline</button>
                    <button id="btn-interaction-danger" class="btn btn-danger">Danger</button>
                </div>

                <!-- Toggles & Sliders -->
                <div>
                    <h3>Deep Interactions</h3>
                    <div class="slider-container">
                        <label>Range Slider</label>
                        <input id="input-interaction-slider" type="range" class="slider" min="0" max="100" value="50">
                        <span id="slider-value-display">50</span>
                    </div>

                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label>Toggle Switch</label>
                        <label class="toggle-switch">
                            <input id="input-interaction-toggle" type="checkbox">
                            <span class="slider-toggle"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <h3>Browser Terminal</h3>
                <div id="browser-terminal"
                    style="background-color: #1e1e1e; color: #00ff00; font-family: monospace; padding: 15px; border-radius: 5px; height: 150px; overflow-y: auto;">
                    <div>$ Ready for interactions...</div>
                </div>
                <button id="btn-clear-terminal" class="btn btn-outline"
                    style="margin-top: 10px; font-size: 0.8rem;">Clear Terminal</button>
            </div>
        </div>
    </div>

    </div>

    <!-- DYNAMIC MODULE LOADER -->
    <script type="module">
        // Helper to load modules reliably
        async function loadModule(path, initFunctionName) {
            try {
                const module = await import(path);
                if (module && typeof module[initFunctionName] === 'function') {
                    console.log(`Loaded module: ${path}`);
                    module[initFunctionName]();
                } else {
                    console.warn(`Module loaded but function '${initFunctionName}' missing: ${path}`);
                }
            } catch (err) {
                console.warn(`â„¹Optional module not found or failed to load: ${path}`);
                console.debug(err);
            }
        }

        // Initialize Core Modules (Auth is typically required for full app flow, but can be optional too)
        loadModule('./js/modules/auth.js', 'initAuth');
        loadModule('./js/modules/playground.js', 'initPlayground');
        loadModule('./js/modules/api_tester.js', 'initApiTester');
        loadModule('./js/modules/interactions.js', 'initInteractions');

        // You can add more modules here easily!
        // loadModule('./js/modules/new-feature.js', 'initNewFeature');
    </script>
</body>

</html>